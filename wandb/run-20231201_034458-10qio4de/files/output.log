
train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:14,  1.58s/it]




train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:12<00:00,  1.21s/it]
train:   0%|                                                                                                                     | 0/10 [00:00<?, ?it/s]
    epoch          : 1
    mel_loss       : 1.4742012023925781
    fm_loss        : 0.05923708155751228
    gan_loss       : 6.1421027183532715
    loss           : 277.9873046875
    discriminator loss: 7.964443683624268
    grad norm dis  : 8.10518741607666

train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:10,  1.21s/it]





train:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 9/10 [00:10<00:01,  1.19s/it]
    epoch          : 2
    mel_loss       : 2.0369279384613037
    fm_loss        : 0.2157718390226364
    gan_loss       : 1.7448077201843262
    loss           : 80.98481750488281
    discriminator loss: 4.68681526184082
    grad norm dis  : 4.8947858810424805
train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:12<00:00,  1.20s/it]
train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:11,  1.23s/it]




train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.18s/it]
train:   0%|                                                                                                                     | 0/10 [00:00<?, ?it/s]
    epoch          : 3
    mel_loss       : 1.5530028343200684
    fm_loss        : 0.113932304084301
    gan_loss       : 4.197368144989014
    loss           : 190.6624298095703
    discriminator loss: 4.459925174713135
    grad norm dis  : 18.139022827148438
    grad norm gen  : 2964.119140625





train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.15s/it]
train:   0%|                                                                                                                     | 0/10 [00:00<?, ?it/s]
    epoch          : 4
    mel_loss       : 1.7976605892181396
    fm_loss        : 0.13738083839416504
    gan_loss       : 2.058776617050171
    loss           : 94.71737670898438
    discriminator loss: 4.2437334060668945
    grad norm dis  : 2.796576738357544
    grad norm gen  : 70.02845001220703





train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.17s/it]
train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:10,  1.21s/it]
    epoch          : 5
    mel_loss       : 1.6881084442138672
    fm_loss        : 0.7640161514282227
    gan_loss       : 3.2795917987823486
    loss           : 150.7977752685547
    discriminator loss: 2.8184332847595215
    grad norm dis  : 22.130903244018555
    grad norm gen  : 2015.4530029296875





train:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 9/10 [00:10<00:01,  1.14s/it]
    epoch          : 6
    mel_loss       : 2.9072155952453613
    fm_loss        : 0.7300221920013428
    gan_loss       : 3.8766815662384033
    loss           : 178.81793212890625
    discriminator loss: 3.5049116611480713
    grad norm dis  : 14.547019004821777
train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.15s/it]
train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:10,  1.21s/it]




train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.15s/it]
train:   0%|                                                                                                                     | 0/10 [00:00<?, ?it/s]
    epoch          : 7
    mel_loss       : 1.9136269092559814
    fm_loss        : 0.12130741029977798
    gan_loss       : 2.2856011390686035
    loss           : 105.00829315185547
    discriminator loss: 4.034195423126221
    grad norm dis  : 10.698719024658203

train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:11,  1.23s/it]




train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:12<00:00,  1.21s/it]
train:   0%|                                                                                                                     | 0/10 [00:00<?, ?it/s]
    epoch          : 8
    mel_loss       : 1.6859593391418457
    fm_loss        : 0.5664178133010864
    gan_loss       : 3.063382148742676
    loss           : 140.67100524902344
    discriminator loss: 3.1594481468200684
    grad norm dis  : 53.11674880981445

train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:11,  1.25s/it]





train:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 9/10 [00:10<00:01,  1.21s/it]
    epoch          : 9
    mel_loss       : 2.0345571041107178
    fm_loss        : 0.7934075593948364
    gan_loss       : 3.6036689281463623
    loss           : 165.78646850585938
    discriminator loss: 3.597594738006592
    grad norm dis  : 32.44945526123047
train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:12<00:00,  1.20s/it]
train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:11,  1.25s/it]





train:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 9/10 [00:10<00:01,  1.17s/it]
    epoch          : 10
    mel_loss       : 2.0492727756500244
    fm_loss        : 0.5127789974212646
    gan_loss       : 2.856236219406128
    loss           : 131.60545349121094
    discriminator loss: 5.371976852416992
    grad norm dis  : 42.33784103393555
train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.19s/it]
train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:10,  1.17s/it]





train:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 9/10 [00:10<00:01,  1.24s/it]
    epoch          : 11
    mel_loss       : 2.762563705444336
    fm_loss        : 0.3960060179233551
    gan_loss       : 5.91364860534668
    loss           : 269.66876220703125
    discriminator loss: 2.1916589736938477
    grad norm dis  : 10.192513465881348
train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:12<00:00,  1.22s/it]
train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:11,  1.26s/it]





train:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 9/10 [00:10<00:01,  1.17s/it]
    epoch          : 12
    mel_loss       : 1.6389737129211426
    fm_loss        : 0.2680828869342804
    gan_loss       : 3.08180570602417
    loss           : 140.8563995361328
    discriminator loss: 3.8557069301605225
    grad norm dis  : 82.49388885498047
train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.20s/it]
train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:10,  1.21s/it]




train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.16s/it]
train:   0%|                                                                                                                     | 0/10 [00:00<?, ?it/s]
    epoch          : 13
    mel_loss       : 2.0065793991088867
    fm_loss        : 0.33796048164367676
    gan_loss       : 3.3621301651000977
    loss           : 153.9783477783203
    discriminator loss: 4.461080551147461
    grad norm dis  : 28.764312744140625

train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:10,  1.21s/it]




train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.19s/it]
train:   0%|                                                                                                                     | 0/10 [00:00<?, ?it/s]
    epoch          : 14
    mel_loss       : 1.6187065839767456
    fm_loss        : 3.162083625793457
    gan_loss       : 15.885504722595215
    loss           : 722.7905883789062
    discriminator loss: 3.2113170623779297
    grad norm dis  : 21.024118423461914
    grad norm gen  : 70688.5





train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.18s/it]
train:   0%|                                                                                                                     | 0/10 [00:00<?, ?it/s]
    epoch          : 15
    mel_loss       : 1.7735087871551514
    fm_loss        : 0.09055807441473007
    gan_loss       : 2.3960444927215576
    loss           : 109.77662658691406
    discriminator loss: 3.951465606689453
    grad norm dis  : 7.297980785369873
    grad norm gen  : 211.55052185058594





train:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 9/10 [00:10<00:01,  1.14s/it]
    epoch          : 16
    mel_loss       : 1.8902907371520996
    fm_loss        : 0.0845445916056633
    gan_loss       : 2.2751688957214355
    loss           : 104.44197845458984
    discriminator loss: 3.7469751834869385
    grad norm dis  : 9.64681625366211
train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.15s/it]
train:   0%|                                                                                                                     | 0/10 [00:00<?, ?it/s]





train:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 9/10 [00:10<00:01,  1.15s/it]
    epoch          : 17
    mel_loss       : 3.2634682655334473
    fm_loss        : 0.3888928294181824
    gan_loss       : 2.898066520690918
    loss           : 134.45425415039062
    discriminator loss: 5.120202541351318
    grad norm dis  : 23.9715576171875
train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.16s/it]
train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:10,  1.18s/it]





train:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 9/10 [00:10<00:01,  1.14s/it]
    epoch          : 18
    mel_loss       : 2.1426515579223633
    fm_loss        : 0.1715576946735382
    gan_loss       : 1.8683868646621704
    loss           : 86.56317138671875
    discriminator loss: 4.4127020835876465
    grad norm dis  : 34.146026611328125
train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.15s/it]
train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:10,  1.17s/it]




train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.17s/it]
train:   0%|                                                                                                                     | 0/10 [00:00<?, ?it/s]
    epoch          : 19
    mel_loss       : 2.469102621078491
    fm_loss        : 0.15984630584716797
    gan_loss       : 2.5012922286987305
    loss           : 115.3469467163086
    discriminator loss: 3.769141674041748
    grad norm dis  : 24.126026153564453
    grad norm gen  : 4246.22607421875





train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.16s/it]
train:   0%|                                                                                                                     | 0/10 [00:00<?, ?it/s]
    epoch          : 20
    mel_loss       : 2.2658019065856934
    fm_loss        : 0.12401512265205383
    gan_loss       : 2.951235771179199
    loss           : 135.31942749023438
    discriminator loss: 3.9121596813201904
    grad norm dis  : 11.52308177947998
    grad norm gen  : 255.55506896972656





train:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 9/10 [00:10<00:01,  1.14s/it]
    epoch          : 21
    mel_loss       : 1.971336007118225
    fm_loss        : 0.22810278832912445
    gan_loss       : 2.7545690536499023
    loss           : 126.38314819335938
    discriminator loss: 3.369425058364868
    grad norm dis  : 27.182849884033203
train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.14s/it]
train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:10,  1.18s/it]





train:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 9/10 [00:10<00:01,  1.21s/it]
    epoch          : 22
    mel_loss       : 2.049844264984131
    fm_loss        : 0.31709057092666626
    gan_loss       : 2.3463845252990723
    loss           : 108.27133178710938
    discriminator loss: 3.660698890686035
    grad norm dis  : 22.204111099243164
train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:12<00:00,  1.20s/it]
train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:10,  1.18s/it]





train:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 9/10 [00:10<00:01,  1.16s/it]
    epoch          : 23
    mel_loss       : 2.0279035568237305
    fm_loss        : 0.5941969156265259
    gan_loss       : 2.418508291244507
    loss           : 112.0491714477539
    discriminator loss: 3.4755735397338867
    grad norm dis  : 8.871591567993164
train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.17s/it]
train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:11,  1.23s/it]




train: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:11<00:00,  1.15s/it]
train:   0%|                                                                                                                     | 0/10 [00:00<?, ?it/s]
    epoch          : 24
    mel_loss       : 1.9021201133728027
    fm_loss        : 0.2813481390476227
    gan_loss       : 2.5391080379486084
    loss           : 116.72467803955078
    discriminator loss: 3.636422634124756
    grad norm dis  : 7.375778675079346

train:  10%|██████████▉                                                                                                  | 1/10 [00:01<00:10,  1.17s/it]

train:  20%|█████████████████████▊                                                                                       | 2/10 [00:03<00:14,  1.75s/it]
Saving model on keyboard interrupt
Saving checkpoint: saved/models/deepspeech/1201_034455/checkpoint-epoch25.pth ...
Traceback (most recent call last):
  File "/home/mac-mvak/code_disk/HiFi-GAN/train.py", line 113, in <module>
    main(config)
  File "/home/mac-mvak/code_disk/HiFi-GAN/train.py", line 77, in main
    trainer.train()
  File "/home/mac-mvak/code_disk/HiFi-GAN/hw_hifi/base/base_trainer.py", line 76, in train
    raise e
  File "/home/mac-mvak/code_disk/HiFi-GAN/hw_hifi/base/base_trainer.py", line 72, in train
    self._train_process()
  File "/home/mac-mvak/code_disk/HiFi-GAN/hw_hifi/base/base_trainer.py", line 84, in _train_process
    result = self._train_epoch(epoch)
  File "/home/mac-mvak/code_disk/HiFi-GAN/hw_hifi/trainer/trainer.py", line 107, in _train_epoch
    batch = self.process_batch(
  File "/home/mac-mvak/code_disk/HiFi-GAN/hw_hifi/trainer/trainer.py", line 185, in process_batch
    metrics.update("grad norm gen", self.get_grad_norm_gen())
  File "/home/mac-mvak/code_disk/HiFi-GAN/.venv/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/mac-mvak/code_disk/HiFi-GAN/hw_hifi/trainer/trainer.py", line 257, in get_grad_norm_gen
    [torch.norm(p.grad.detach(), norm_type).cpu() for p in parameters]
  File "/home/mac-mvak/code_disk/HiFi-GAN/hw_hifi/trainer/trainer.py", line 257, in <listcomp>
    [torch.norm(p.grad.detach(), norm_type).cpu() for p in parameters]
KeyboardInterrupt